#include "GerberCommandApertureMacro.h"


#define ADD_PRIMITIVE(type) 	type*	pcPrimitive;\
pcPrimitive = (type*)macPrimitives.Add(sizeof(type)); \
New<type>(pcPrimitive);


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CGerberCommandApertureMacro::Init(size iNameLength)
{
	CGerberCommand::Init(GC_AM);
	szName.InitLength(iNameLength);
	macPrimitives.Init();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CGerberCommandApertureMacro::Kill(void)
{
	size					i;
	size					uiNumElements;
	CGerberApertureMacro*	pcCommand;


	uiNumElements = macPrimitives.NumElements();
	for (i = 0; i < uiNumElements; i++)
	{
		pcCommand = (CGerberApertureMacro*)macPrimitives.Get(i);
		pcCommand->Kill();
	}
	macPrimitives.Kill();
	szName.Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
char* CGerberCommandApertureMacro::NameText(void)
{
	return szName.Text();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroComment* CGerberCommandApertureMacro::AddComment(size uiLength)
{
	ADD_PRIMITIVE(CGerberApertureMacroComment);
	pcPrimitive->Init(uiLength);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroCircle* CGerberCommandApertureMacro::AddCircle(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroCircle);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroCenterLine* CGerberCommandApertureMacro::AddCenterLine(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroCenterLine);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroOutline* CGerberCommandApertureMacro::AddOutline(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroOutline);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroPolygon* CGerberCommandApertureMacro::AddPolygon(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroPolygon);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroVectorLine* CGerberCommandApertureMacro::AddVectorLine(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroVectorLine);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacroThermal* CGerberCommandApertureMacro::AddThermal(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace)
{
	ADD_PRIMITIVE(CGerberApertureMacroThermal);
	pcPrimitive->Init(pcSymbols, bSkipWhitespace, false);
	return pcPrimitive;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CGerberCommandApertureMacro::IsApertureMacro(void)
{
	return true;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
size CGerberCommandApertureMacro::NumPrimitives(void)
{
	return macPrimitives.NumElements();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CGerberApertureMacro* CGerberCommandApertureMacro::GetPrimitive(size uiIndex)
{
	return (CGerberApertureMacro*)macPrimitives.Get(uiIndex);
}

