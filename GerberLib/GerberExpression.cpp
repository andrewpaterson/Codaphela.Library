#include "GerberExpression.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CGerberExpression::Init(CCalculatorSymbols* pcSymbols, bool bSkipWhitespace, bool bUseUserError)
{
	mcCalculator.Init(pcSymbols, bSkipWhitespace, bUseUserError);
	mpcExpression = NULL;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CGerberExpression::Kill(void)
{
	mcCalculator.Kill();
	mpcExpression = NULL;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CGerberExpression::SetCalcExpression(CCalcExpression* pcExpression)
{
	mpcExpression = pcExpression;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CCalculator* CGerberExpression::GetCalculator(void)
{
	return &mcCalculator;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CNumber* CGerberExpression::GetConstNumber(void)
{
	CCalcConstExpression*	pcConst;

	if (mpcExpression->IsConstExpression())
	{
		pcConst = (CCalcConstExpression*)mpcExpression;
		return pcConst->GetNumber();
	}
	return NULL;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
float64 CGerberExpression::DoubleValue(void)
{
	CCalcConstExpression*	pcConst;
	CNumber*				pcNumber;

	if (mpcExpression->IsConstExpression())
	{
		pcConst = (CCalcConstExpression*)mpcExpression;
		pcNumber = pcConst->GetNumber();
		if (pcNumber != NULL)
		{
			return pcNumber->DoubleValue();
		}
	}
	return NAN;
}

