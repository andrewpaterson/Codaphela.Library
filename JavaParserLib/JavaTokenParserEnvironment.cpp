#include "JavaTokenParserEnvironment.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTokenParserEnvironment::Init(char* szFilename, char* szText, BOOL bBreakOnError)
{
	int		iTextLen;

	iTextLen = strlen(szText);
	Init(szFilename, szText, iTextLen, bBreakOnError);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTokenParserEnvironment::Init(char* szFilename, char* szText, int iTextLen, BOOL bBreakOnError)
{
	mcLogger.Init();
	mcLogger.SetBreakOnError(bBreakOnError);
	mcTokenDefinitions.Init();
	mcTokenMemory.Init();
	mcTokenParser.Init(&mcLogger, &mcTokenDefinitions, &mcTokenMemory, szFilename, szText, iTextLen);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CTokenParserEnvironment::Kill(void)
{
	mcTokenParser.Kill();
	mcTokenMemory.Kill();
	mcTokenDefinitions.Kill();
	mcLogger.Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CTokenParserEnvironment::Parse(BOOL bFailOnError)
{
	return mcTokenParser.Parse(bFailOnError);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
CJavaTokenParser* CTokenParserEnvironment::GetParser(void)
{
	return &mcTokenParser;
}

