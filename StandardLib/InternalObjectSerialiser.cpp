#include "ObjectSerialiser.h"
#include "InternalObjectSerialiser.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CInternalObjectSerialiser::Init(CObjectWriter* pcWriter)
{
	mpcWriter = pcWriter;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CInternalObjectSerialiser::Kill(void)
{
	mpcWriter = NULL;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CInternalObjectSerialiser::Write(CBaseObject* pcObject)
{
	CObjectSerialiser	cSerialiser;
	BOOL				bResult;
	CSerialisedObject*	pcSerialised;

	ReturnOnFalse(mpcWriter->Begin());

	cSerialiser.Init(this, pcObject);

	bResult = cSerialiser.Save();
	ReturnOnFalse(bResult);

	pcSerialised = (CSerialisedObject*)cSerialiser.GetData();

	bResult = mpcWriter->Write(pcSerialised);
	ReturnOnFalse(bResult);

	cSerialiser.Kill();

	return mpcWriter->End();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CInternalObjectSerialiser::AddDependent(CBaseObject* pcObject)
{
}

