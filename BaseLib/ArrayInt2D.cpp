/** ---------------- COPYRIGHT NOTICE, DISCLAIMER, and LICENSE ------------- **

Copyright (c) 2022 Andrew Paterson

This file is part of The Codaphela Project: Codaphela BaseLib

Codaphela BaseLib is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Codaphela BaseLib is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with Codaphela BaseLib.  If not, see <http://www.gnu.org/licenses/>.

Microsoft Windows is Copyright Microsoft Corporation

** ------------------------------------------------------------------------ **/
#include "ArrayTemplate.h"
#include "ArrayInt2D.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::Init(void)
{
	mcArray.Init();
	miWidth = 0;
	miHeight = 0;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::Kill(void)
{
	mcArray.Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
int CArrayInt2D::AddColumn(void)
{
	int	iOldWidth;

	iOldWidth = miWidth;
	InsertColumns(miWidth-1, 1);
	return iOldWidth;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
int CArrayInt2D::AddRow(void)
{
	int	iOldHeight;

	iOldHeight = miHeight;
	InsertRows(miHeight-1, 1);
	return iOldHeight;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::InsertColumn(int iColumn)
{
	InsertColumns(iColumn, 1);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::InsertRow(int iRow)
{
	InsertRows(iRow, 1);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::RemoveColumn(int iColumn)
{
	RemoveColumns(iColumn, 1);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::RemoveRow(int iRow)
{
	RemoveRows(iRow, 1);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::SetColumns(int iNumColumns)
{
	if (miHeight == 0)
	{
		miWidth = iNumColumns;
	}
	else
	{
		if (iNumColumns > miWidth)
		{
			if (miWidth > 0)
			{
				InsertColumns(miWidth, iNumColumns-miWidth);
			}
			else
			{
				InsertColumns(0, iNumColumns);
			}
		}
		else if (iNumColumns < miWidth)
		{
			RemoveColumns(iNumColumns, miWidth-iNumColumns);
		}
	}
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::SetRows(int iNumRows)
{
	if (miWidth == 0)
	{
		miHeight = iNumRows;
	}
	else
	{
		if (iNumRows > miHeight)
		{
			if (miHeight > 0)
			{
				InsertRows(miHeight, iNumRows-miHeight);
			}
			else
			{
				InsertRows(0, iNumRows);
			}
		}
		else if (iNumRows < miHeight)
		{
			RemoveRows(iNumRows, miHeight-iNumRows);
		}	
	}
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::SetSize(int iNumColumns, int iNumRows)
{
	SetColumns(iNumColumns);
	SetRows(iNumRows);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::InsertColumns(int iColumn, int iCount)
{
	//Naive implementation, fix as necessary.
	int		i;

	for (i = miHeight-1; i >= 0; i--)
	{
		mcArray.InsertNumAt(iCount, i*miWidth + iColumn);
	}
	miWidth += iCount;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::InsertRows(int iRow, int iCount)
{
	mcArray.InsertNumAt(iCount * miWidth, iRow * miWidth);
	miHeight += iCount;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::RemoveColumns(int iColumn, int iCount)
{
	//Naive implementation, fix as necessary.
	int		i;

	for (i = miHeight-1; i >= 0; i--)
	{
		mcArray.RemoveRange(i*miWidth + iColumn, i*miWidth + iColumn+iCount);
	}
	miWidth -= iCount;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::RemoveRows(int iRow, int iCount)
{
	mcArray.RemoveRange(iRow * miWidth, (iRow+iCount) * miWidth, true);
	miHeight -= iCount;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
int CArrayInt2D::Get(int x, int y)
{
	return mcArray.GetValue(x + y*miWidth);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::Set(int x, int y, int iValue)
{
	mcArray.SetValue(x + y*miWidth, iValue);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
int CArrayInt2D::SafeGet(int x, int y, int iNullValue)
{
	if (((x >= 0) && (x < miWidth)) && ((y >= 0) && (y < miHeight)))
	{
		return mcArray.GetValue(x + y*miWidth);
	}
	return iNullValue;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::SafeSet(int x, int y, int iValue)
{
	if (((x >= 0) && (x < miWidth)) && ((y >= 0) && (y < miHeight)))
	{
		return mcArray.SetValue(x + y*miWidth, iValue);
	}
}

	
//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::Fill(int iX1, int iY1, int iX2, int iY2, int iValue)
{
	int		x;
	int		y;

	for (y = iY1; y < iY2; y++)
	{
		for (x = iX1; x < iX2; x++)
		{
			mcArray.SetValue(x + y*miWidth, iValue);
		}
	}
}



	
//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CArrayInt2D::CountFill(int iX1, int iY1, int iX2, int iY2)
{
	int		x;
	int		y;
	int		iValue;

	iValue = 0;
	for (y = iY1; y < iY2; y++)
	{
		for (x = iX1; x < iX2; x++)
		{
			mcArray.SetValue(x + y*miWidth, iValue);
			iValue++;
		}
	}
}
