#include "CalculatorError.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorError::Init(bool bUseUserError)
{
	mbUseUserError = bUseUserError;
	mszError.Init();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorError::Kill(void)
{
	mszError.Kill();
}



//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorError::SetError(char* szError)
{
	mszError.Append(szError);
	if (mbUseUserError)
	{
		gcUserError.Set(szError);
	}
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CCalculatorError::HasError(void)
{
	return !mszError.Empty();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
char* CCalculatorError::GetError(void)
{
	return mszError.Text();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
bool CCalculatorError::UseUserError(void)
{
	return mbUseUserError;
}

