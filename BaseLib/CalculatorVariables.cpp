#include "CalculatorVariables.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorVariables::Init(void)
{
	mapcExpressionDefintions.Init();
	mmszpcVariables.Init(true, false);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorVariables::Kill(void)
{
	size			uiNumElements;
	CCalcObject*	pcCalcObject;
	size			i;

	mmszpcVariables.Kill();

	uiNumElements = mapcExpressionDefintions.NumElements();
	for (i = 0; i < uiNumElements; i++)
	{
		pcCalcObject = mapcExpressionDefintions.GetPtr(i);
		SafeKill(pcCalcObject);
	}
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorVariables::Add(CCalcVariableDefinition* pcVariableDefinition)
{
	mapcExpressionDefintions.Add(pcVariableDefinition);
	mmszpcVariables.Put(pcVariableDefinition->GetName(), &pcVariableDefinition);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CCalculatorVariables::Add(CCalcExpression* pcExpression)
{
	mapcExpressionDefintions.Add(pcExpression);
}

