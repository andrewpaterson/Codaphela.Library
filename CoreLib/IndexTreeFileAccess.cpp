#include "IndexTreeFileAccess.h"


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CIndexTreeFileAccess::Init(CIndexTreeFile* pcTree, BOOL bImmediate)
{
	CIndexTreeAccess::Init();
	mpcTree = pcTree;
	mbImmediate = bImmediate;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
void CIndexTreeFileAccess::Kill(void)
{
	mpcTree = NULL;
	CIndexTreeAccess::Kill();
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CIndexTreeFileAccess::Put(void* pvKey, int iKeySize, void* pvObject, unsigned char uiDataSize)
{
	return mpcTree->Put(pvKey, iKeySize, pvObject, uiDataSize);
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CIndexTreeFileAccess::Get(void* pvKey, int iKeySize, void* pvObject, int* piDataSize)
{
	unsigned short	uiDataSize;
	BOOL			bResult;

	bResult = mpcTree->Get(pvKey, iKeySize, pvObject, &uiDataSize);

	if (piDataSize)
	{
		*piDataSize = uiDataSize;
	}
	return bResult;
}


//////////////////////////////////////////////////////////////////////////
//
//
//////////////////////////////////////////////////////////////////////////
BOOL CIndexTreeFileAccess::Remove(void* pvKey, int iKeySize)
{
	if (mbImmediate)
	{
		return mpcTree->Remove(pvKey, iKeySize);
	}
	else
	{
		return mpcTree->Delete(pvKey, iKeySize);
	}
}

